{% block content %}
{% load staticfiles %}

    <script type="text/x-template" id="topPlayer">  <!--сам плеер (родительский элемент)-->
        <div>
            <link rel="stylesheet" type="text/css" href="{% static 'mainapp/css/audio.css' %}" />
            <link id="playerCSS" rel="stylesheet" type="text/css" :href="CSSRef" />
            <div id="player" @mouseenter="onMouseEnter" @mouseleave="onMouseLeave">
                <div class="player-container" :style="containerMove">
                    <buttons :isFull="isFull" @nextclick="playNextTrack" @dropdownclick="switchPlayerView"></buttons>
                    <logos ref="logos" v-bind="logos" @likepressed="onLikePressed" :isFull="isFull"></logos>
                    <menu-more :performerID="performerID"></menu-more>
                    <track-performer v-bind="trackPerformer"></track-performer>
                    <volume-controller ref="volumeController" :isFull="isFull"></volume-controller>
                    <audio-player ref="audioPlayer" v-bind="audio" @playingended="playingEnded"></audio-player>
                    <queue v-bind="queue"></queue>
                    <!--<img class="Button Player" id="previousButton" src="" draggable="false" />-->
                </div>
                
                <progress-bar :isPlayerHovered="isHovered" :isFull="isFull"></progress-bar>
            </div>
        </div>
    </script>

    <script type="text/x-template" id="buttons"> <!--общий компонент для обычных кнопок (play, next, dropdown)-->
        <div>
            <img src="{% static 'mainapp/images/nextButton.png' %}" class="Button previous-button" @click="" draggable="false" />
            <img :src="playSrc" class="Button play-button" @click="playClick" draggable="false" />
            <img src="{% static 'mainapp/images/nextButton.png' %}" class="Button next-button" @click="nextClick" draggable="false" />
            <img :src="dropdownSrc" class="Button dropdown-button" @click="dropdownClick" draggable="false" />
        </div>
    </script>

    <script type="text/x-template" id="logos"> <!--компонент для всех лого-->
        <div>
            <div class="Button main-logo" @click="click" @mouseenter="onMouseEnterMain" @mouseleave="onMouseLeaveMain" :style="mainLogoAnimation">
                <img id=vinyl src="{% static 'mainapp/images/redVinyl.png' %}">
                <img id="logo" :src="logoLink" draggable="false" :style="rotationCSS"/>
                <img class="Player" id="like" v-show="showLike" src="{% static 'mainapp/images/like.png' %}" draggable="false"/>
            </div>
            <img class="main-to-prev-logo" :src="logo" draggable="false" :style="mainToPrevLogoAnimation"/>
            <img class="next-to-main-logo" :src="logoLink" draggable="false" :style="nextToMainLogoAnimation"/>
            <img class="prev-envelope" :src="logo" draggable="false" :style="prevEnvelopeAnimation"/>
            <img class="Button prev-logo" :src="prevLogo" v-show="showPrev" draggable="false" :style="prevLogoAnimation"/>
            <img class="Button next-logo" @click="nextLogoClick" :src="nextLogoLink" draggable="false" :style="nextLogoAnimation"/>
            <img class="next-envelope" :src="nextEnvelopeLogo" draggable="false" :style="nextEnvelopeAnimation"/>
        </div>
    </script>

    <script type="text/x-template" id="menuMore"> <!--компонент для меню "больше"-->
        <div class="menu" @click="toggleDrop">
            <img class="Button" id="menuPic" src="{% static 'mainapp/images/menu.png' %}" draggable="false"/>
            <transition name="menu-more">
                <ul id="menuDropdown" v-show="showMenu" @mouseleave="closeDrop">
                    <li class="Button"><router-link :to="{ name: 'performer', params: { id: this.performerID }}"><p class="menuElements">На страницу исполнителя</p></router-link></li>
                    <li class="Button"><p class="menuElements">Добавить в избранное</p></li>
                    <li class="Button"><p class="menuElements">Пожаловаться</p></li>
                </ul>
            </transition>
        </div>
    </script>

    <script type="text/x-template" id="trackPerformer"> <!-- компонент для имени трека и исполнителя -->
        <div class="track-performer-name">
            <p class="track-name" id="trackname">{{ '{{' }} trackName }}</p>
            <p class="performer-name" id="performername">{{ '{{' }} performerName }}</p>
        </div>
    </script>

    <script type="text/x-template" id="volumeController"> <!-- компонент для контроллера громкости -->
    <div>
        <div v-show="showVolume || isFull" class="volume-control-zone" @mouseleave="mouseLeave" @mouseenter="mouseEnter">
            <transition>
                <div class="volume" >
                    <div class="volume-background" v-show="showVolume"></div>
                    <!--<div class="Player Button" id="draggingZone"></div>
                    <img class="Button" id = "ball" src="{% static 'mainapp/images/circle.png' %}" draggable="false"/>
                    <div class="Player Button" id="line"></div>
                    <div id="fillingLine"></div>-->
                    <vue-slider-component @drag-end="dragEnd" @drag-start="dragStart" v-model="value" :show="showVolume" ref="slider" v-bind="sliderprops"></vue-slider-component>
                </div>
            </transition>

            
            <!--<div id="fullVolume" @mouseenter="refreshFunc">
                <vue-slider-component ref="fullSlider" v-model="value" :show="showFullVolume && isFull" v-bind="sliderpropsFull"></vue-slider-component>
            </div>-->
            
        </div>
        <img @mouseenter="openSpeaker" @click="clickSpeaker" class="Button speaker" id="speakerPic" :src="speakerPic" draggable="false"/>
    </div>
    </script>
    


    <script type="text/x-template" id="progressBar">  <!-- компонент для полоски прогресса -->
        <!--<div class="Button" id ="progress">
            <p id="playedTime">0:00</p>
            <p id="trackLength"></p>
            <div class="Player Button" id="progressLine"></div>
            <div id="progressBarLine"></div>
        </div>-->
        <div class="vue-simple-progress">
            <vue-slider-component @drag-end="dragEnd" @drag-start="dragStart" @mouseup.native="click" v-model="currentTime" ref="slider" v-bind="sliderPropsComputed" :max="sliderMax"></vue-slider-component>
            <!--<div class="foreground-progress-bar" :style="bar_style + height_style"></div>-->
            <div class="background-progress-bar" :style="bar_style + transition"></div>
            <!--<div v-show="isPlayerHovered" class="played-time">{{ '{{' }}playedTimeTop}}</div>
            <div v-show="isPlayerHovered || isFull" class="track-length">{{ '{{' }}trackLengthTop}}</div>-->
        </div>
    </script>

    <script type="text/x-template" id="audioPlayer">  <!-- компонент для элемента audio -->
        <audio id="audio" ref="audio" :src="audioLink" @loadeddata="startPlaying" @ended="endPlaying" preload> <!-- @timeupdate="setCurrentTime" -->
        </audio>
    </script>

    <script type="text/x-template" id="queue">  <!-- компонент для элемента audio -->
        <div class="queue">
            <!--<img @click="openQueue" class="Button queue-button" src="{% static 'mainapp/images/queue.svg' %}" draggable="false"/>-->
            <transition name="queue">
                <div class="queue-list" v-show="showQueue" @mouseleave="">
                    <div @mouseenter="mouseEnterElement(index)" @mouseleave="mouseLeaveElement(index)" class="queue-element" v-for="(track, index) in tracksComputed">
                        <img :src="track.img" class="queue-img"/>
                        <span :style="track.style" class="queue-text">{{ '{{' }} track.text }}</span>
                        <!--<img src="{% static 'mainapp/images/playButton.png' %}" class="queue-play">-->
                    </div>
                </div>
            </transition>
        </div>
    </script>

    {% include "mainapp/vue-slider-component/template.html" %} <!-- подрубочка внешнего, скачанного компонента слайдера -->

    <script src="{% static 'mainapp/js/audio.js' %}"></script>
{% endblock %}